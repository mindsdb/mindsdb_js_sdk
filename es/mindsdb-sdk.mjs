import e from"axios";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t,n,r,a,o,u){try{var c=e[o](u),i=c.value}catch(e){return void n(e)}c.done?t(i):Promise.resolve(i).then(r,a)}function r(e){return function(){var t=this,r=arguments;return new Promise((function(a,o){var u=e.apply(t,r);function c(e){n(u,a,o,c,i,"next",e)}function i(e){n(u,a,o,c,i,"throw",e)}c(void 0)}))}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);t>n;n++)r[n]=e[n];return r}var i=function(e,t){var n="";return e?(e.forEach((function(e,t){if(e.value){var r=encodeURIComponent(e.key)+"="+(e.noEncodeURIComponent?e.value:encodeURIComponent(e.value));n=n.concat(t>0?"&".concat(r):r)}})),n.length>0?t+"?"+n:t):t},s={url:null,api:null,token:{key:"apikey",value:null},version:.2},p=function(){var e=r(regeneratorRuntime.mark((function e(n){var r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i([s.token],"/util/ping"),e.next=3,s.api.get(r);case 3:if(200!==(a=e.sent).status||"object"!==t(a.data)||"ok"!==a.data.status){e.next=6;break}return e.abrupt("return",!0);case 6:return e.abrupt("return",!1);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=r(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i([].concat(u(t),[s.token]),"/config/logs"),e.next=3,s.api.get(n);case 3:return e.abrupt("return",e.sent.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l=function(){var e=r(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i([s.token],"/config/install_options"),e.next=3,s.api.get(t);case 3:return e.abrupt("return",e.sent.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),d=function(){var e=r(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i([s.token],"/config/vars"),e.next=3,s.api.get(t);case 3:return e.abrupt("return",e.sent.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),m=function(){var e=r(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i([s.token],"/config/".concat(t,"/").concat(n)),e.next=3,s.api.get(r);case 3:return e.abrupt("return",e.sent.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),h=function(e){return new k(e)},v=function(e){return new w(e)},g=function(e,t){var n=window.URL.createObjectURL(new Blob([e.data])),r=document.createElement("a");r.href=n;var a=e.headers["content-disposition"],o=null;if(a){var u=a.match(/filename="?(.+)"?/);2===u.length&&(o=u[1])}if(!o&&t){var c=t.split("/"),i=c[c.length-1];c=i.split("\\"),o=i=c[c.length-1]}r.setAttribute("download",o=o||"unknown"),document.body.appendChild(r),r.click(),r.remove(),window.URL.revokeObjectURL(n)},k=function e(t){var n=this;a(this,e),o(this,"loaded",!1),o(this,"name",""),o(this,"version",""),o(this,"is_active",!1),o(this,"data_source",""),o(this,"predict",null),o(this,"accuracy",0),o(this,"status",""),o(this,"train_end_at",null),o(this,"updated_at",null),o(this,"created_at",null),o(this,"data_preparation",null),o(this,"data_analysis",null),o(this,"model_analysis",null),o(this,"columns",null),o(this,"code_from_json_ai",function(){var e=r(regeneratorRuntime.mark((function e(t){var r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t?[].concat(u(t),[s.token]):[s.token],a=i(r,"/predictors/code_from_json_ai/".concat(n.name)),e.next=4,s.api.get(a);case 4:return e.abrupt("return",response.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),o(this,"jsonAI_edit",function(){var e=r(regeneratorRuntime.mark((function e(t){var r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t?[].concat(u(t),[s.token]):[s.token],a=i(r,"/predictors/lwr/jsonai/edit/".concat(n.name)),e.next=4,s.api.put(a);case 4:return e.abrupt("return",response.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),o(this,"codeAI_edit",function(){var e=r(regeneratorRuntime.mark((function e(t){var r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t?[].concat(u(t),[s.token]):[s.token],a=i(r,"/predictors/lwr/code/edit/".concat(n.name)),e.next=4,s.api.put(a);case 4:return e.abrupt("return",response.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),o(this,"load",function(){var e=r(regeneratorRuntime.mark((function e(t){var r,a,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t?[].concat(u(t),[s.token]):[s.token],a="/predictors/",void 0!==n.name&&""!==n.name&&(a+="".concat(n.name)),o=i(r,a),e.next=6,s.api.get(o);case 6:return Object.assign(n,e.sent.data),e.abrupt("return",n);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),o(this,"rename",function(){var e=r(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t?[].concat(u(t),[s.token]):[s.token],r=i(n,"/predictors/".concat(t.oldName,"/rename?new_name=").concat(t.newName)),e.next=4,s.api.get(r);case 4:return e.abrupt("return",e.sent.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),o(this,"loadColumns",function(){var e=r(regeneratorRuntime.mark((function e(t){var r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t?[].concat(u(t),[s.token]):[s.token],a=i(r,"/predictors/".concat(n.name,"/columns")),e.next=4,s.api.get(a);case 4:return n.columns=e.sent.data,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),o(this,"update",function(){var e=r(regeneratorRuntime.mark((function e(t,n){var r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t?[].concat(u(t),[s.token]):[s.token],a=i(r,"/predictors/".concat(n,"/update")),e.next=4,s.api.get(a);case 4:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),o(this,"learn_lwr",function(){var e=r(regeneratorRuntime.mark((function e(t,r,a){var o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=a?[].concat(u(a),[s.token]):[s.token],c=i(o,"/predictors/lwr/generate/".concat(n.name)),e.next=4,s.api.put(c,{data_source_name:t,problem_definition:r});case 4:return e.abrupt("return",response.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()),o(this,"learn",function(){var e=r(regeneratorRuntime.mark((function e(t,r){var a,o,c,p,f,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.dataSourceName,o=t.fromData,p={to_predict:t.toPredict},(c=t.kwargs)&&(p.kwargs=c),a?p.data_source_name=a:o&&(p.from_data=o),f=r?[].concat(u(r),[s.token]):[s.token],l=i(f,"/predictors/".concat(n.name)),e.next=8,s.api.put(l,p);case 8:return e.abrupt("return",e.sent.data);case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),o(this,"queryPredict",function(){var e=r(regeneratorRuntime.mark((function e(t,r,a){var o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=r?[].concat(u(r),[s.token]):[s.token],c=i(o,"/predictors/".concat(n.name,"/predict")),e.next=4,s.api.post(c,{when:t,format_flag:a});case 4:return e.abrupt("return",e.sent.data);case 6:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()),o(this,"delete",function(){var e=r(regeneratorRuntime.mark((function e(t){var r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t?[].concat(u(t),[s.token]):[s.token],a=i(r,"/predictors/".concat(n.name)),e.next=4,s.api.delete(a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),o(this,"upload",function(){var e=r(regeneratorRuntime.mark((function e(t,n,r){var a,o,c,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r?[].concat(u(r),[s.token]):[s.token],(o=new FormData).append("file",t),c={onUploadProgress:function(e){n&&n(Math.round(100*e.loaded/e.total))}},p=i(a,"/predictors/upload"),e.next=7,s.api.post(p,o,c);case 7:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()),o(this,"download",function(){var e=r(regeneratorRuntime.mark((function e(t){var r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t?[].concat(u(t),[s.token]):[s.token],a=i(r,"/predictors/".concat(n.name,"/download")),e.next=4,s.api.get(a,{responseType:"blob"});case 4:return g(e.sent),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),o(this,"getDownloadUrl",(function(){return"".concat(s.url,"/predictors/").concat(n.name,"/download")})),Object.assign(this,t)},w=function e(t){var n=this;a(this,e),o(this,"loaded",!1),o(this,"source_type","url"),o(this,"name",""),o(this,"source",""),o(this,"missed_files",!1),o(this,"created_at",null),o(this,"updated_at",null),o(this,"row_count",0),o(this,"columns",null),o(this,"data",null),o(this,"missedFileList",null),o(this,"load",function(){var e=r(regeneratorRuntime.mark((function e(t){var r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t?[].concat(u(t),[s.token]):[s.token],a=i(r,"/datasources/".concat(n.name)),e.next=4,s.api.get(a);case 4:return Object.assign(n,e.sent.data),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),o(this,"upload",function(){var e=r(regeneratorRuntime.mark((function e(t,r,a){var o,c,p,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.source_type="file",n.source=t.name,o=a?[].concat(u(a),[s.token]):[s.token],(c=new FormData).append("name",n.name),c.append("source_type",n.source_type),c.append("source",n.source),c.append("file",t),p={onUploadProgress:function(e){r&&r(Math.round(100*e.loaded/e.total))},timeout:6e5},f=i(o,"/datasources/".concat(n.name)),e.next=12,s.api.put(f,c,p);case 12:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()),o(this,"uploadFromUrl",function(){var e=r(regeneratorRuntime.mark((function e(t,r){var a,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.source_type="url",n.source=t,a={name:n.name,source_type:n.source_type,source:n.source},o=r?[].concat(u(r),[s.token]):[s.token],c=i(o,"/datasources/".concat(n.name)),e.next=7,s.api.put(c,a);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),o(this,"download",function(){var e=r(regeneratorRuntime.mark((function e(t){var r,a,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.getDownloadUrl(),a=t?[].concat(u(t),[s.token]):[s.token],o=i(a,r),e.next=5,s.api.get(o,{responseType:"blob"});case 5:return g(e.sent,n.source),e.abrupt("return",n);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),o(this,"getDownloadUrl",(function(){return"url"===n.source_type?n.source:"".concat(s.url,"/datasources/").concat(n.name,"/download")})),o(this,"delete",function(){var e=r(regeneratorRuntime.mark((function e(t){var r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t?[].concat(u(t),[s.token]):[s.token],a=i(r,"/datasources/".concat(n.name)),e.next=4,s.api.delete(a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),o(this,"loadData",function(){var e=r(regeneratorRuntime.mark((function e(t){var r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t?[].concat(u(t),[s.token]):[s.token],a=i(r,"/datasources/".concat(n.name,"/data/")),e.next=4,s.api.get(a);case 4:return n.data=e.sent.data,e.abrupt("return",n.data);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),o(this,"loadDataQuality",function(){var e=r(regeneratorRuntime.mark((function e(t){var r,a,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t?[].concat(u(t),[s.token]):[s.token],a=i(r,"/datasources/".concat(n.name,"/analyze")),e.prev=2,e.next=5,s.api.get(a);case 5:o={data_preparation:(c=e.sent).data.data_preparation,data_analysis_v2:c.data.data_analysis_v2,useable_input_columns:c.data.useable_input_columns,current_phase:c.data.current_phase,versionNative:c.data.version,status:c.data&&c.data.status},e.next=13;break;case 9:e.prev=9,e.t0=e.catch(2),Object.assign(n,{error:e.t0}),console.error(e.t0);case 13:return n.dataQuality=o,e.abrupt("return",o);case 15:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}()),o(this,"loadMissedFileList",function(){var e=r(regeneratorRuntime.mark((function e(t){var r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t?[].concat(u(t),[s.token]):[s.token],a=i(r,"/datasources/".concat(n.name,"/missed_files")),e.next=4,s.api.get(a);case 4:return n.missedFileList=e.sent.data,e.abrupt("return",n.missedFileList);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),o(this,"uploadFile",function(){var e=r(regeneratorRuntime.mark((function e(t,r){var a,o,c,p,f,l,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.column,o=t.rowIndex,c=t.extension,p=t.file,(f=new FormData).append("file",p),f.append("extension",c),l=r?[].concat(u(r),[s.token]):[s.token],d=i(l,"/datasources/".concat(n.name,"/files/").concat(a,":").concat(o)),e.next=8,s.api.put(d,f);case 8:return e.abrupt("return",200===e.sent.status);case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),Object.assign(this,t)},y=function e(t){var n=this;a(this,e),o(this,"loaded",!1),o(this,"source_type","url"),o(this,"integration",[]),o(this,"load",function(){var e=r(regeneratorRuntime.mark((function e(t){var r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t?[].concat(u(t),[s.token]):[s.token],e.prev=1,a=i(r,"config/all_integrations"),e.next=5,s.api.get(a);case 5:return Object.assign(n,e.sent),e.abrupt("return",n);case 10:e.prev=10,e.t0=e.catch(1),Object.assign(n,{error:e.t0}),console.error(e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}()),o(this,"delete",function(){var e=r(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.api.delete("/config/integrations/".concat(t.db_name));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),o(this,"check",function(){var e=r(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.api.get("/config/integrations/".concat(t.integrations_name,"/check"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),o(this,"edit",function(){var e=r(regeneratorRuntime.mark((function e(t,n){var r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n?[].concat(u(n),[s.token]):[s.token],a=i(r,"/config/integrations/".concat(t.params.integrations_name)),e.next=4,s.api.post(a,t);case 4:return e.abrupt("return",e.sent.data);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),o(this,"create",function(){var e=r(regeneratorRuntime.mark((function e(t,n){var r,a,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(o in r=n?[].concat(u(n),[s.token]):[s.token],a=new FormData,t.params)a.append(o,t.params[o]);return null!=t&&t.ssl&&(null!=t&&t.ssl_ca&&a.set("ssl_ca",t.ssl_ca),null!=t&&t.ssl_cert&&a.set("ssl_cert",t.ssl_cer),null!=t&&t.ssl_key&&a.set("ssl_key",null==t?void 0:t.ssl_key)),c=i(r,"/config/integrations/".concat(t.params.integrations_name)),e.next=7,s.api.put(c,a);case 7:return e.abrupt("return",e.sent.data);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),o(this,"newDataset",function(){var e=r(regeneratorRuntime.mark((function e(t,n){var r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n?[].concat(u(n),[s.token]):[s.token],e.prev=1,a=i(r,"/datasources/".concat(t.name)),e.next=5,s.api.put(a,t);case 5:return e.abrupt("return",e.sent);case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,n){return e.apply(this,arguments)}}()),Object.assign(this,t)},x={connect:function(t,n){s.token.value=n.find((function(e){return"apikey"===e.key})).value,s.url=i([s.token],t),s.api=e.create({baseURL:t})},disconnect:function(){s.url=null,s.token={key:"apikey",value:null},s.api=null},ping:p,logs:f,dependencies:l,installDependencies:function(){var e=r(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i([s.token],"/config/install/".concat(t)),e.next=3,s.api.get(n);case 3:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getEnvs:d,uppdateVar:m,predictors:function(){var e=r(regeneratorRuntime.mark((function e(t){var n,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t?[].concat(u(t),[s.token]):[s.token],r=i(n,"/predictors/"),e.next=4,s.api.get(r);case 4:return a=(e.sent.data||[]).map(h),e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),dataSources:function(){var e=r(regeneratorRuntime.mark((function e(t){var n,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t?[].concat(u(t),[s.token]):[s.token],r=i(n,"/datasources/"),e.next=4,s.api.get(r);case 4:return a=(e.sent.data||[]).map(v),e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),DataSource:v,Predictor:h,DataBase:function(e){return new y(e)}};export default x;
